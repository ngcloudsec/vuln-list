{
  "mitigation": "From the maintainer:\nFor Apache MINA SSHD \u003c= 2.9.1, do not use org.apache.sshd.server.keyprovider.SimpleGeneratorHostKeyProvider to generate and later load your server's host key. Use separately generated host key files, for instance in OpenSSH format, and load them via a org.apache.sshd.common.keyprovider.FileKeyPairProvider instead. Or use a custom implementation instead of \nSimpleGeneratorHostKeyProvider that uses the OpenSSH format for storing and loading the host key (via classes OpenSSHKeyPairResourceWriter and OpenSSHKeyPairResourceParser).",
  "affected_release": [
    {
      "product_name": "Text-Only RHOAR",
      "release_date": "2022-12-13T00:00:00Z",
      "advisory": "RHSA-2022:8957",
      "package": "sshd-common",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    }
  ],
  "package_state": [
    {
      "product_name": "Migration Toolkit for Applications 6",
      "fix_state": "Affected",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:migration_toolkit_applications:6"
    },
    {
      "product_name": "Migration Toolkit for Runtimes",
      "fix_state": "Affected",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:migration_toolkit_runtimes:1"
    },
    {
      "product_name": "OpenShift Developer Tools and Services",
      "fix_state": "Under investigation",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:ocp_tools"
    },
    {
      "product_name": "Red Hat build of Quarkus",
      "fix_state": "Affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:quarkus:2"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Affected",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Out of support scope",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Integration Camel for Spring Boot",
      "fix_state": "Not affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3.14"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Not affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Camel Quarkus",
      "fix_state": "Affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:camel_quarkus:2.7"
    },
    {
      "product_name": "Red Hat JBoss A-MQ 7",
      "fix_state": "Not affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Out of support scope",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "keycloak-adapter-sso7_5-eap6",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Out of support scope",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Not affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Fuse 6",
      "fix_state": "Out of support scope",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:jboss_fuse:6"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "fix_state": "Affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    },
    {
      "product_name": "Red Hat JBoss Fuse Service Works 6",
      "fix_state": "Out of support scope",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:jboss_fuse_service_works:6"
    },
    {
      "product_name": "Red Hat OpenShift Application Runtimes",
      "fix_state": "Not affected",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Affected",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Affected",
      "package_name": "opendaylight",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Out of support scope",
      "package_name": "mina-sshd",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "fix_state": "Affected",
      "package_name": "sshd-common",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    },
    {
      "product_name": "Red Hat Virtualization 4",
      "fix_state": "Affected",
      "package_name": "apache-sshd",
      "cpe": "cpe:/:redhat:enterprise_linux:::hypervisor"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2022-11-16T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2022-45047 mina-sshd: Java unsafe deserialization vulnerability",
    "id": "2145194",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2145194"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-502",
  "statement": "Red Hat Impact as High as there's a mitigation for minimizing the impact which the flaw requires org.apache.sshd.server.keyprovider.SimpleGeneratorHostKeyProvider to be impacted, which would require an external/public API for an attacker to benefit from it. \nRed Hat Fuse 7 and Red Hat JBoss Enterprise Application Platform 7 have a lower rate (moderate) as it's very unlikely to be exploited since those are for internal usage or use a custom implementation in their case.",
  "acknowledgement": "",
  "name": "CVE-2022-45047",
  "document_distribution": "",
  "details": [
    "Class org.apache.sshd.server.keyprovider.SimpleGeneratorHostKeyProvider in Apache MINA SSHD \u003c= 2.9.1 uses Java deserialization to load a serialized java.security.PrivateKey. The class is one of several implementations that an implementor using Apache MINA SSHD can choose for loading the host keys of an SSH server.",
    "A flaw was found in Apache MINA SSHD, when using Java deserialization to load a serialized java.security.PrivateKey. An attacker could benefit from unsafe deserialization by inserting unsecured data that may affect the application or server."
  ],
  "references": [
    "https://www.mail-archive.com/dev@mina.apache.org/msg39312.html"
  ]
}