{
  "mitigation": "This flaw may be avoided by ensuring that any external inputs used with the Commons-Text lookup methods are sanitized properly. Untrusted input should always be thoroughly sanitized before using in any potentially risky situations.",
  "affected_release": [
    {
      "product_name": "Red Hat AMQ Broker 7",
      "release_date": "2022-12-07T00:00:00Z",
      "advisory": "RHSA-2022:8876",
      "package": "commons-text",
      "cpe": "cpe:/a:redhat:amq_broker:7"
    },
    {
      "product_name": "Red Hat Integration",
      "release_date": "2022-12-08T00:00:00Z",
      "advisory": "RHSA-2022:8902",
      "package": "commons-text",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat JBoss Fuse 7",
      "release_date": "2022-11-28T00:00:00Z",
      "advisory": "RHSA-2022:8652",
      "package": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_fuse:7"
    }
  ],
  "package_state": [
    {
      "product_name": "A-MQ Clients 2",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:a_mq_clients:2"
    },
    {
      "product_name": "Logging Subsystem for Red Hat OpenShift",
      "fix_state": "Not affected",
      "package_name": "openshift-logging/elasticsearch6-rhel8",
      "cpe": "cpe:/a:redhat:logging:5"
    },
    {
      "product_name": "OpenShift Developer Tools and Services",
      "fix_state": "Affected",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:ocp_tools"
    },
    {
      "product_name": "Red Hat A-MQ Online",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:amq_online:1"
    },
    {
      "product_name": "Red Hat build of Quarkus",
      "fix_state": "Affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:quarkus:2"
    },
    {
      "product_name": "Red Hat Data Grid 8",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_data_grid:8"
    },
    {
      "product_name": "Red Hat Decision Manager 7",
      "fix_state": "Out of support scope",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_enterprise_brms_platform:7"
    },
    {
      "product_name": "Red Hat Integration Camel for Spring Boot",
      "fix_state": "Affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:camel_spring_boot:3.14"
    },
    {
      "product_name": "Red Hat Integration Camel K",
      "fix_state": "Affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Camel Quarkus",
      "fix_state": "Affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:camel_quarkus:2.7"
    },
    {
      "product_name": "Red Hat Integration Change Data Capture",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:integration:1"
    },
    {
      "product_name": "Red Hat Integration Service Registry",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:service_registry:2.0.0"
    },
    {
      "product_name": "Red Hat JBoss A-MQ Streams",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:amq_streams:1"
    },
    {
      "product_name": "Red Hat JBoss Data Grid 7",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_data_grid:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 6",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:6"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform 7",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_enterprise_application_platform:7"
    },
    {
      "product_name": "Red Hat JBoss Enterprise Application Platform Expansion Pack",
      "fix_state": "Affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jbosseapxp"
    },
    {
      "product_name": "Red Hat JBoss Web Server 5",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_enterprise_web_server:5"
    },
    {
      "product_name": "Red Hat OpenShift Application Runtimes",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:openshift_application_runtimes:1.0"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Will not fix",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "jenkins-2-plugins",
      "cpe": "cpe:/a:redhat:openshift:4"
    },
    {
      "product_name": "Red Hat Process Automation 7",
      "fix_state": "Out of support scope",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:jboss_enterprise_bpms_platform:7"
    },
    {
      "product_name": "Red Hat Satellite 6",
      "fix_state": "Affected",
      "package_name": "candlepin",
      "cpe": "cpe:/a:redhat:satellite:6"
    },
    {
      "product_name": "Red Hat Single Sign-On 7",
      "fix_state": "Not affected",
      "package_name": "commons-text",
      "cpe": "cpe:/a:redhat:red_hat_single_sign_on:7"
    }
  ],
  "threat_severity": "Critical",
  "public_date": "2022-10-13T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2022-42889 apache-commons-text: variable interpolation RCE",
    "id": "2135435",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2135435"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "9.8",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-94-\u003eCWE-1188",
  "statement": "In order to carry a successful exploitation of this vulnerability, the following steps should be in place in the affected target:\n- Usage of specific methods that interpolate the variables as described in the flaw\n- Usage of external input for those methods\n- Usage of that external input has to be unsanitized/no \"allow list\"/etc.\nThe following products have *Low* impact because they have maven references to the affected package but does not ship it nor use the code:\n- Red Hat EAP Expansion Pack (EAP-XP)\n- Red Hat Camel-K\n- Red Hat Camel-Quarkus\nRed Hat Satellite ships Candlepin that embeds Apache Commons Text, however, it is not vulnerable to the flaw since library has not been exposed in the product code. In Candlepin, the Commons Text is being pulled for the Liquibase and ActiveMQ Artemis libraries as a dependency. Red Hat Product Security has evaluated and rated the impact of the flaw as Low for Satellite since there was no harm identified to confidentiality, integrity, or availability of systems.\nOpenShift 3.11 is already in the ELS support model phase. The Jenkins components are out of scope of the ELS support, hence OpenShift 3.11 Jenkins component is marked in this CVE as \"Will not fix.",
  "acknowledgement": "",
  "name": "CVE-2022-42889",
  "document_distribution": "",
  "details": [
    "Apache Commons Text performs variable interpolation, allowing properties to be dynamically evaluated and expanded. The standard format for interpolation is \"${prefix:name}\", where \"prefix\" is used to locate an instance of org.apache.commons.text.lookup.StringLookup that performs the interpolation. Starting with version 1.5 and continuing through 1.9, the set of default Lookup instances included interpolators that could result in arbitrary code execution or contact with remote servers. These lookups are: - \"script\" - execute expressions using the JVM script execution engine (javax.script) - \"dns\" - resolve dns records - \"url\" - load values from urls, including from remote servers Applications using the interpolation defaults in the affected versions may be vulnerable to remote code execution or unintentional contact with remote servers if untrusted configuration values are used. Users are recommended to upgrade to Apache Commons Text 1.10.0, which disables the problematic interpolators by default.",
    "A flaw was found in Apache Commons Text packages 1.5 through 1.9.  The affected versions allow an attacker to benefit from a variable interpolation process contained in Apache Commons Text, which can cause properties to be dynamically defined. Server applications are vulnerable to remote code execution (RCE) and unintentional contact with untrusted remote servers."
  ],
  "references": [
    "https://seclists.org/oss-sec/2022/q4/22\nhttps://lists.apache.org/thread/n2bd4vdsgkqh2tm14l1wyc3jyol7s1om\nhttps://blogs.apache.org/security/entry/cve-2022-42889"
  ]
}