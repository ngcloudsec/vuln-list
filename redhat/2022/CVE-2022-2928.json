{
  "mitigation": "Possible workaround - Disable lease query on the server for DHCPv4 or restart the server periodically.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "dhcp",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "dhcp",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "dhcp",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "dhcp",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2022-10-05T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2022-2928 dhcp: option refcount overflow when leasequery is enabled leading to dhcpd abort",
    "id": "2132002",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2132002"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "6.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-190",
  "statement": "Vulnerable servers are network accessible to an attacker and configured to allow and process lease queries.\nInternally, reference counters are integers and thus overflow at 2^31 references, so even at 1000 lease query responses per second, it would take more than three weeks to crash the server.",
  "acknowledgement": "Upstream acknowledges VictorV (Cyber Kunlun Lab) as the original reporter.",
  "name": "CVE-2022-2928",
  "document_distribution": "",
  "details": [
    "In ISC DHCP 4.4.0 -\u003e 4.4.3, ISC DHCP 4.1-ESV-R1 -\u003e 4.1-ESV-R16-P1, when the function option_code_hash_lookup() is called from add_option(), it increases the option's refcount field. However, there is not a corresponding call to option_dereference() to decrement the refcount field. The function add_option() is only used in server responses to lease query packets. Each lease query response calls this function for several options, so eventually, the reference counters could overflow and cause the server to abort.",
    "An integer overflow vulnerability was found in the DHCP server. When the \"option_code_hash_lookup()\" function is called from \"add_option()\", it increases the option's \"refcount\" field. However, there is not a corresponding call to \"option_dereference()\" to decrement the \"refcount\" field. The \"add_option()\" function is only used in server responses to lease query packets. Each lease query response calls this function for several options. Hence, a DHCP server configured with \"allow lease query,\" a remote machine with access to the server, can send lease queries for the same lease multiple times, leading to the \"add_option()\" function being called repeatedly. This issue could cause the reference counters to overflow and the server to abort or crash."
  ],
  "references": [
    "https://kb.isc.org/docs/cve-2022-2928"
  ]
}