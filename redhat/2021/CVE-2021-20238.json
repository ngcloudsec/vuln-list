{
  "mitigation": "- If deployed on Baremetal, OpenStack, Ovirt, Vsphere or KubeVirt, check if the ignition config is accessible from outside the cluster, e.g.\nhttps://api.$cluster_name.$base_domain:22623/config/worker\nPrevent access to this endpoint with an external firewall or load balancer.\n- To protect the MCS endpoint within clusters, use a supported network plugin with OpenShift, namely: OpenShift SDN, OVN Kubernetes or kuryr.\n- Ensure untrusted workloads are not run with hostNetwork access.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat OpenShift Container Platform 3.11",
      "fix_state": "Not affected",
      "package_name": "atomic-openshift",
      "cpe": "cpe:/a:redhat:openshift:3.11"
    },
    {
      "product_name": "Red Hat OpenShift Container Platform 4",
      "fix_state": "Affected",
      "package_name": "openshift4/ose-machine-config-operator",
      "cpe": "cpe:/a:redhat:openshift:4"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2021-02-05T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2021-20238 openshift/machine-config-operator: unauthenticated access to Machine Config Server ignition config",
    "id": "1926568",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1926568"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.6",
    "cvss3_scoring_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-287",
  "statement": "This flaw is planned to be addressed in a future enhancement:\n* https://issues.redhat.com/browse/GRPA-3642\n-  https://github.com/openshift/enhancements/pull/443\n-  https://github.com/openshift/enhancements/pull/626",
  "acknowledgement": "",
  "name": "CVE-2021-20238",
  "document_distribution": "",
  "details": [
    "It was found in OpenShift Container Platform 4 that ignition config, served by the Machine Config Server, can be accessed externally from clusters without authentication. The MCS endpoint (port 22623) provides ignition configuration used for bootstrapping Nodes and can include some sensitive data, e.g. registry pull secrets. There are two scenarios where this data can be accessed. The first is on Baremetal, OpenStack, Ovirt, Vsphere and KubeVirt deployments which do not have a separate internal API endpoint and allow access from outside the cluster to port 22623 from the standard OpenShift API Virtual IP address. The second is on cloud deployments when using unsupported network plugins, which do not create iptables rules that prevent to port 22623. In this scenario, the ignition config is exposed to all pods within the cluster and cannot be accessed externally.",
    "It was found in OpenShift Container Platform 4 that ignition config, served by the Machine Config Server, can be accessed externally from clusters without authentication. The MCS endpoint (port 22623) provides ignition configuration used for bootstrapping Nodes and can include some sensitive data, e.g. registry pull secrets.\nThere are two scenarios where this data can be accessed. The first is on Baremetal, OpenStack, Ovirt, Vsphere and KubeVirt deployments which do not have a separate internal API endpoint and allow access from outside the cluster to port 22623 from the standard OpenShift API Virtual IP address.\nThe second is on cloud deployments when using unsupported network plugins, which do not create iptables rules that prevent to port 22623. In this scenario, the ignition config is exposed to all pods within the cluster and cannot be accessed externally."
  ],
  "references": null
}